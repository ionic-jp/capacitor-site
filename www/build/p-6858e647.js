import{d as e,f as t}from"./p-db2aa20e.js";const r=e=>!("isConnected"in e)||e.isConnected,n=(()=>{let e;return(...t)=>{e&&clearTimeout(e),e=setTimeout((()=>{e=0,(e=>{for(let t of e.keys())e.set(t,e.get(t).filter(r))})(...t)}),2e3)}})(),o=(r,o)=>{const s=((e,t=((e,t)=>e!==t))=>{let r=new Map(Object.entries(null!=e?e:{}));const n={dispose:[],get:[],set:[],reset:[]},o=()=>{r=new Map(Object.entries(null!=e?e:{})),n.reset.forEach((e=>e()))},s=e=>(n.get.forEach((t=>t(e))),r.get(e)),a=(e,o)=>{const s=r.get(e);t(o,s,e)&&(r.set(e,o),n.set.forEach((t=>t(e,o,s))))},i="undefined"==typeof Proxy?{}:new Proxy(e,{get:(e,t)=>s(t),ownKeys:()=>Array.from(r.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>r.has(t),set:(e,t,r)=>(a(t,r),!0)}),u=(e,t)=>(n[e].push(t),()=>{((e,t)=>{const r=e.indexOf(t);r>=0&&(e[r]=e[e.length-1],e.length--)})(n[e],t)});return{state:i,get:s,set:a,on:u,onChange:(t,r)=>{const n=u("set",((e,n)=>{e===t&&r(n)})),o=u("reset",(()=>r(e[t])));return()=>{n(),o()}},use:(...e)=>e.forEach((e=>{e.set&&u("set",e.set),e.get&&u("get",e.get),e.reset&&u("reset",e.reset)})),dispose:()=>{n.dispose.forEach((e=>e())),o()},reset:o}})(r,o);return(({on:r})=>{const o=new Map;"function"==typeof e&&(r("dispose",(()=>{o.clear()})),r("get",(t=>{const r=e();r&&((e,t,r)=>{const n=e.get(t);n?n.includes(r)||n.push(r):e.set(t,[r])})(o,t,r)})),r("set",(e=>{const r=o.get(e);r&&o.set(e,r.filter(t)),n(o)})),r("reset",(()=>{o.forEach((e=>e.forEach(t))),n(o)})))})(s),s};let s;const a=e=>{var t;const r=window,n=new URL(r.location.href),a=null!==(t=null==e?void 0:e.parseURL)&&void 0!==t?t:c,{state:i,onChange:u,dispose:p}=o({url:n,activePath:a(n)},((e,t,r)=>"url"===r?e.href!==t.href:e!==t)),f=e=>{history.pushState(null,null,e);const t=new URL(e,document.baseURI);i.url=t,i.activePath=a(t)},d=e=>{const{activePath:t}=i;for(let r of e){const n=l(t,r.path);if(n)return null!=r.to?(f(r.to),d(e)):{params:n,route:r}}},g=()=>{const e=new URL(r.location.href);i.url=e,i.activePath=a(e)},v=s={Switch:(e,t)=>{const r=d(t);if(r)return"function"==typeof r.route.jsx?r.route.jsx(r.params):r.route.jsx},get url(){return i.url},get activePath(){return i.activePath},push:f,onChange:u,dispose:()=>{s=void 0,r.removeEventListener("popstate",g),p()}};return g(),r.addEventListener("popstate",g),v},i=(e,t)=>{var r;return"to"in e?{path:e.path,to:e.to}:{path:e.path,id:e.id,jsx:null!==(r=e.render)&&void 0!==r?r:t}},u=(e,t=s)=>({href:e,onClick:r=>{r.preventDefault(),t.push(e)}}),l=(e,t)=>{if("string"==typeof t){if(t===e)return{}}else if("function"==typeof t){const r=t(e);if(r)return!0===r?{}:{...r}}else{const r=t.exec(e);if(r)return t.lastIndex=0,{...r}}},c=e=>e.pathname.toLowerCase(),p=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g"),f=e=>e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),d=e=>e.replace(/([=!:$/()])/g,"\\$1"),g=e=>e&&e.sensitive?"":"i",v=(e,t,r)=>{for(var n=(r=r||{}).strict,o=!1!==r.end,s=f(r.delimiter||"/"),a=r.delimiters||"./",i=[].concat(r.endsWith||[]).map(f).concat("$").join("|"),u="",l=!1,c=0;c<e.length;c++){var p=e[c];if("string"==typeof p)u+=f(p),l=c===e.length-1&&a.indexOf(p[p.length-1])>-1;else{var d=f(p.prefix||""),v=p.repeat?"(?:"+p.pattern+")(?:"+d+"(?:"+p.pattern+"))*":p.pattern;t&&t.push(p),u+=p.optional?p.partial?d+"("+v+")?":"(?:"+d+"("+v+"))?":d+"("+v+")"}}return o?(n||(u+="(?:"+s+")?"),u+="$"===i?"$":"(?="+i+")"):(n||(u+="(?:"+s+"(?="+i+"))?"),l||(u+="(?="+s+"|"+i+")")),new RegExp("^"+u,g(r))},w=(e,t,r)=>e instanceof RegExp?((e,t)=>{if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e})(e,t):Array.isArray(e)?((e,t,r)=>{for(var n=[],o=0;o<e.length;o++)n.push(w(e[o],t,r).source);return new RegExp("(?:"+n.join("|")+")",g(r))})(e,t,r):((e,t,r)=>v(((e,t)=>{for(var r,n=[],o=0,s=0,a="",i=t&&t.delimiter||"/",u=t&&t.delimiters||"./",l=!1;null!==(r=p.exec(e));){var c=r[0],g=r[1],v=r.index;if(a+=e.slice(s,v),s=v+c.length,g)a+=g[1],l=!0;else{var w="",y=e[s],h=r[2],m=r[3],x=r[4],$=r[5];if(!l&&a.length){var R=a.length-1;u.indexOf(a[R])>-1&&(w=a[R],a=a.slice(0,R))}a&&(n.push(a),a="",l=!1);var P=w||i,b=m||x;n.push({name:h||o++,prefix:w,delimiter:P,optional:"?"===$||"*"===$,repeat:"+"===$||"*"===$,partial:""!==w&&void 0!==y&&y!==w,pattern:b?d(b):"[^"+f(P)+"]+?"})}}return(a||s<e.length)&&n.push(a+e.substr(s)),n})(e,r),t,r))(e,t,r);let y=0;const h={},m=(e,t={})=>{const{exact:r=!1,strict:n=!1}=t,{re:o,keys:s}=((e,t)=>{const r=`${t.end}${t.strict}`,n=h[r]||(h[r]={}),o=JSON.stringify(e);if(n[o])return n[o];const s=[],a={re:w(e,s,t),keys:s};return y<1e4&&(n[o]=a,y+=1),a})(e,{end:r,strict:n});return e=>{const t=o.exec(e);if(!t)return;const[n,...a]=t;return r&&e!==n?void 0:s.reduce(((e,t,r)=>(e[t.name]=a[r],e)),{})}};export{i as R,a,o as c,u as h,m}