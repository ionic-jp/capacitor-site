{"page.state":{"announcement_bar":{},"title":"Security Advisory CVE-2020-6506","description":"A security vulnerability discovered in Android WebView.","slug":"security-advisory-cve-2020-6506","date":"2020-09-16T08:00:00.000Z","authorName":"Max Lynch","authorUrl":"https://twitter.com/maxlynch","html":"<p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3 paragraph-intro\">Vulnerability detail: <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-6506\">https://nvd.nist.gov/vuln/detail/CVE-2020-6506</a></p> <p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3 paragraph-intro\">A universal cross-site scripting security vulnerability was discovered in Android WebView that allows cross-origin iframes or links to execute arbitrary JavaScript in the top-level document. For an attack to be successful, a user would need to navigate to a website or iframe containing malicious code within WebView. The vulnerability has been fixed in Android WebView as of version 83.0.4103.106, however users must update their Android WebView from the Google Play Store.</p> <p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3 paragraph-intro\">For users of the outdated Android WebView, Capacitor apps loading third party content in iframes or directly in the web view are only vulnerable if precautions are not taken. We are currently exploring a solution to help mitigate the vulnerability. We recommend taking the following precautions if your application may be vulnerable:</p> <h2 class=\"ui-heading ui-heading-2 ui-theme--editorial\" id=\"capacitor-configuration-capacitorconfigjson\"><a href=\"#capacitor-configuration-capacitorconfigjson\" class=\"heading-anchor\" aria-hidden=\"true\"></a>Capacitor configuration (<code>capacitor.config.json</code>)</h2><p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\">The best line of defense is to only allow first-party trusted content in the web view.</p> <ul> <li class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\">Do not modify the server.url to a third party or <strong>untrusted</strong> website.</li> <li class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\">Do not add <strong>untrusted</strong> websites to server.allowNavigation.</li> </ul> <p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\">It is recommended that apps behaving as a web browser use the Browser plugin.</p> <h2 class=\"ui-heading ui-heading-2 ui-theme--editorial\" id=\"html-iframes\"><a href=\"#html-iframes\" class=\"heading-anchor\" aria-hidden=\"true\"></a>HTML iframes</h2><p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\">Care should be taken when using iframes in your application. If you need to include an iframe in your page, make sure the content is from a trusted source.</p> <p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\">The vulnerability can be mitigated by using the sandbox attribute. Using an empty value is the most restrictive configuration that will prevent an attack.</p> <pre class=\"language-html\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>iframe</span> <span class=\"token attr-name\">sandbox</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://example.com/risky.html<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>iframe</span><span class=\"token punctuation\">&gt;</span></span></code></pre> <p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\"><strong>Caution</strong>: tokens can be added to the sandbox attribute to lift certain restrictions, however some configurations will cause an app to remain vulnerable, such as <code>“allow-popups allow-top-navigation allow-scripts”</code>.</p> <h2 class=\"ui-heading ui-heading-2 ui-theme--editorial\" id=\"further-information\"><a href=\"#further-information\" class=\"heading-anchor\" aria-hidden=\"true\"></a>Further Information</h2><p class=\"ui-paragraph ui-paragraph--prose ui-paragraph-3\">More information about the vulnerability can be found at <a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=1083819\">https://bugs.chromium.org/p/chromium/issues/detail?id=1083819</a> and <a href=\"https://alesandroortiz.com/articles/uxss-android-webview-cve-2020-6506/\">https://alesandroortiz.com/articles/uxss-android-webview-cve-2020-6506/</a>. Many thanks to Alesandro Ortiz for bringing this to our attention.</p>"},"components":["announcement-bar","site-backdrop","docs-dropdown","blog-subnav","blog-post","ion-icon","docs-search","more-button","site-header","site-root","capacitor-site"]}